<!DOCTYPE html>
<html lang="en">
{% include head.html %}
<body>

    <div class="container">
        <!-- LEFT SIDEBAR (The Brand Anchor) -->
        {% include sidebar.html %}

        <!-- RIGHT CONTENT (The Product Canvas) -->
        <main class="content">
            <header class="mobile-header">
                <div class="mobile-header-inner">
                    <a href="{{ '/' | relative_url }}" class="mobile-logo-link" aria-label="Swai Electronics Home">
                        <img src="{{ '/assets/images/mobile-logo.svg' | relative_url }}?v={{ site.time | date: '%s' }}" alt="Swai Electronics" class="mobile-logo">
                    </a>
                    <button class="hamburger-menu" id="filtersToggle" aria-label="Filters & Search" aria-expanded="false">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                </div>
            </header>

            {% if paginator %}
            <div class="mobile-inline-filters" id="mobileFilters" aria-hidden="true">
                <div class="filter-inner">
                    <div class="filter-chips" id="categoryChips" aria-label="Category filters">
                        <a href="#" class="chip active filter-link" data-filter="all">All</a>
                        <a href="#" class="chip filter-link" data-filter="televisions">TVs</a>
                        <a href="#" class="chip filter-link" data-filter="audio">Audio</a>
                        <a href="#" class="chip filter-link" data-filter="home-appliances">Appliances</a>
                        <a href="#" class="chip filter-link" data-filter="on-sale">On Sale</a>
                    </div>
                </div>
            </div>
            {% endif %}

            {{ content }}
            
            {% include footer.html %}
        </main>
    </div>

    <script>
        // Collapsible filters toggle (mobile)
        const filtersToggle = document.getElementById('filtersToggle');
        const mobileFilters = document.getElementById('mobileFilters');
        if (filtersToggle && mobileFilters) {
            filtersToggle.addEventListener('click', () => {
                const isOpen = mobileFilters.classList.toggle('open');
                filtersToggle.classList.toggle('active', isOpen);
                filtersToggle.setAttribute('aria-expanded', isOpen);
                mobileFilters.setAttribute('aria-hidden', !isOpen);
            });
        }

        // Optional: dynamically generate category chips from product cards if needed
        document.addEventListener('DOMContentLoaded', () => {
            const chipContainer = document.getElementById('categoryChips');
            if (chipContainer) {
                const cards = Array.from(document.querySelectorAll('.product-card'));
                const existing = new Set(['all','televisions','audio','home-appliances','on-sale']);
                const cats = Array.from(new Set(cards.map(c => c.getAttribute('data-category')).filter(Boolean)));
                cats.forEach(cat => {
                    if (!existing.has(cat)) {
                        const a = document.createElement('a');
                        a.href = '#';
                        a.className = 'chip filter-link';
                        a.dataset.filter = cat;
                        a.textContent = cat.replace('-', ' ');
                        chipContainer.appendChild(a);
                    }
                });
            }
        });
        if (window.netlifyIdentity) {
            window.netlifyIdentity.on("init", user => {
            if (!user) {
                window.netlifyIdentity.on("login", () => {
                document.location.href = "/cms-admin/";
                });
            }
            });
        }
    </script>
    {% include consent_analytics.html %}
    {% include offer_card.html %}
</body>
</html>